---
geometry: margin = 1in
output: pdf_document
---

\pagenumbering{gobble}

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
yt <- 0
```

# Modeling count data
## Stat 340, Fall 2021

\bigskip

## Your turn `r (yt <- yt + 1)`: Poisson-Gamma model

Let $X_{1},X_{2},\ldots,X_{n}$ be a random sample from the Poisson distribution with PMF 
$$f(x)=\dfrac{\lambda^{x}e^{-\lambda}}{x!},\ x=0,1,2,\ldots$$

1. Write down the likelihood function, $f(x_1, \ldots, x_n | \lambda)$.

\vspace{1.25in}

2. Suppose that you decide to use a Gamma(a,b) prior distribution for $\lambda$ with PDF

    $$\pi(\lambda)=\dfrac{b^{a}}{\Gamma(a)}\lambda^{a-1}e^{-b\lambda},\ \lambda>0.$$ 

    Find the posterior density of $\lambda$.
    
    \vspace{3.75in}

3. Is the gamma prior a conjugate family to the Poisson likelihood?

\clearpage

## Your turn `r (yt <- yt + 1)`: Tuning a gamma prior

After thinking about how many scam phone calls I receive per day (before collecting data), my best guess is that this rate...

- is expected to be around 5 calls per day, and

- could reasonably range from 2 to 7 calls per day.

Translate my prior belief into a gamma prior distribution for $\lambda$. (You can use the `bayesrules::plot_gamma()` function to quickly plot a proposed distribution to help check you prior.)

\vspace{2in}


## Your turn `r (yt <- yt + 1)`: Inference for count data

Over the first two weeks of the term, I recorded the number of scam calls I received and stored them in a vector:

```{r}
calls <- c(2, 1, 5, 5, 1, 3, 3, 1, 3, 3, 0, 6, 1, 1)
```

Give statistically sound estimates using the posterior distribution we discussed (though more work may be required in some cases).

1. How many scam calls should I expect on average in a typical day?

    \vspace{1.25in}

2. How many scam calls should I expect tomorrow?

    \vspace{1.25in}

3. How many scam calls should I expect in the next week (7 days)?


